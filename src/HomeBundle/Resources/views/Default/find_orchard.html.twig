{% extends '::base.html.twig' %}

{% block body %}
<!--huertos / eventos + input-->
  <div class="row row-centered">
    <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12 col-centered">
      <div class="find-title">
        <button id="btn-orchards" type="button" class="btn btn-link">{{ 'find.orchard'|trans }}</button> &nbsp;&nbsp; / &nbsp;&nbsp; <a href="/find/event"><button id="btn-events" type="button" class="btn btn-link">{{ 'find.events'|trans }}</button></a>
      </div>
      <form id="form-home_search" action="/find/orchard" method="post">
        <input id="input-home_search" name="input-home_search" type="text" value="{{ input_home_search }}" placeholder="{{ 'home.find.placeholder'|trans }}"><button id="btn-home_search" class="button" type="submit">{{ 'home.btn.search'|trans }}</button>
        <input id="user_latitude" name="user_latitude" type="text" hidden="hidden">
        <input id="user_longitude" name="user_longitude" type="text" hidden="hidden">
      </form>
      <p>{{ 'find.results-1'|trans }} {{ orchards|length }} {{ 'find.results-2'|trans }}</p>
    </div>
  </div>

<input id="type" type="text" value="find" hidden="hidden">


<div class="row">
  <!--RESULTADOS-->
  <div class="col-lg-7 col-md-7 col-xs-12 col-sm-12">
    <div class="left-scroll">
      {% if type == 'distance' %}<!-- SI SE TIENE LA UBUCACION DEL USUARIO -->
      {% for orchard in orchards %}
      <a href="/orchard/show/profile/{{ orchard.0.id }}">
        <div class="col-lg-6 col-md-6 col-xs-12 col-sm-12">
          <!-- Imagen -->
          <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
            {% if orchard.0.images is not empty %}
            {% set hasFavourite = false %}
            {% for orchardImage in orchard.0.images %}
                {% if orchardImage.favourite == true %}
                  <div class="find-result" style="background: url({{ asset('/orchard/image/' ~ orchardImage.nameImage) }}); background-position: center;"></div>
                  {% set hasFavourite = true %}
                {% endif %}
            {% endfor %}
            {% if hasFavourite == false %}
            <div class="find-result" style="background: url({{ asset('/orchard/image/' ~ orchard.0.images[0].nameImage) }}); background-position: center;"></div>
            {% endif %}
            {% else %}
            <div class="find-result" style="background: url(http://tratamientosparatodo.hol.es/wp-content/themes/creativemag/images/default.png);"></div>
            {% endif %}
          </div>

          <!-- Texto -->
          <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
            <p><font style="font-size:20px">{{ orchard.0.name }}</font> <br><i>{{ orchard.0.address }}</i></p>
          </div>

          <input type="text" class="geometry" value="{{ orchard.0.geometry }}" hidden="hidden">
        </div>
      </a>
      {% endfor %}

      {% else %}<!-- SI NO SE TIENE LA UBICACION DEL USUARIO -->
      {% for orchard in orchards %}

      <a href="/orchard/show/profile/{{ orchard.id }}">
        <div class="col-lg-6 col-md-6 col-xs-12 col-sm-12">
          <!-- Imagen -->
          <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
            {% if orchard.images is not empty %}
            {% set hasFavourite = false %}
            {% for orchardImage in orchard.images %}
                {% if orchardImage.favourite == true %}
                  <div class="find-result" style="background: url({{ asset('/orchard/image/' ~ orchardImage.nameImage) }}); background-position: center;"></div>
                  {% set hasFavourite = true %}
                {% endif %}
            {% endfor %}
            {% if hasFavourite == false %}
            <div class="find-result" style="background: url({{ asset('/orchard/image/' ~ orchard.images[0].nameImage) }}); background-position: center;"></div>
            {% endif %}
            {% else %}
            <div class="find-result" style="background: url(http://tratamientosparatodo.hol.es/wp-content/themes/creativemag/images/default.png);"></div>
            {% endif %}
          </div>

          <!-- Texto -->
          <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
            <p><font style="font-size:20px">{{ orchard.name }}</font> <br><i>{{ orchard.address }}</i></p>
          </div>

          <input type="text" class="geometry" value="{{ orchard.geometry }}" hidden="hidden">
        </div>
      </a>
      {% endfor %}

      {% endif %}
    </div>
  </div>

  <!--MAPA-->
  {% if orchards is not empty %}
  <div class="map col-xs-12 col-sm-12 col-md-5 col-lg-5">
      <div id="map-show" class="map-show" style="height: 63vh;"></div>
  </div>
  {% endif %}

</div>

<script>
$( "div.left-scroll" ).scrollLeft( 300 );

</script>
<script src="{{ asset('/js/map_show.js') }}"></script>
{% endblock %}
